<!doctype html><html lang=en dir=auto>
<head><meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=robots content="index, follow">
<title>Monitor linux statistics with grafana (munin replacement) | Leonardo Lazzaro</title>
<meta name=keywords content>
<meta name=description content="This quick tutorial will guide you to install grafana to monitor a linux system. We also are going to save a history to an influx database.
Installing InfluxDB For Ubuntu
curl -sL https://repos.influxdata.com/influxdb.key | sudo apt-key add - source /etc/lsb-release echo &#34;deb https://repos.influxdata.com/${DISTRIB_ID,,}${DISTRIB_CODENAME}stable&#34; | sudo tee /etc/apt/sources.list.d/influxdb.list Install and start theInfluxDB service:
sudo apt-get update && sudo apt-get install influxdb sudo service influxdb start Now you can check at the port 8083 (for a local installation check http://localhost:3000)) that the InfluxDB is working.">
<meta name=author content>
<link rel=canonical href=https://www.lazzaro.com.ar/post/2016-08-18-using-grafana-to-monitor-linux-or-to-replace-munin/>
<link crossorigin=anonymous href=/assets/css/stylesheet.min.c88963fe2d79462000fd0fb1b3737783c32855d340583e4523343f8735c787f0.css integrity="sha256-yIlj/i15RiAA/Q+xs3N3g8MoVdNAWD5FIzQ/hzXHh/A=" rel="preload stylesheet" as=style>
<script defer crossorigin=anonymous src=/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5+kdJvBz5iKbt6B5PJI=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://www.lazzaro.com.ar/favicon.ico>
<link rel=icon type=image/png sizes=16x16 href=https://www.lazzaro.com.ar/favicon-16x16.png>
<link rel=icon type=image/png sizes=32x32 href=https://www.lazzaro.com.ar/favicon-32x32.png>
<link rel=apple-touch-icon href=https://www.lazzaro.com.ar/apple-touch-icon.png>
<link rel=mask-icon href=https://www.lazzaro.com.ar/safari-pinned-tab.svg>
<meta name=theme-color content="#2e2e33">
<meta name=msapplication-TileColor content="#2e2e33">
<noscript>
<style>#theme-toggle,.top-link{display:none}</style>
<style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style>
</noscript><meta property="og:title" content="Monitor linux statistics with grafana (munin replacement)">
<meta property="og:description" content="This quick tutorial will guide you to install grafana to monitor a linux system. We also are going to save a history to an influx database.
Installing InfluxDB For Ubuntu
curl -sL https://repos.influxdata.com/influxdb.key | sudo apt-key add - source /etc/lsb-release echo &#34;deb https://repos.influxdata.com/${DISTRIB_ID,,}${DISTRIB_CODENAME}stable&#34; | sudo tee /etc/apt/sources.list.d/influxdb.list Install and start theInfluxDB service:
sudo apt-get update && sudo apt-get install influxdb sudo service influxdb start Now you can check at the port 8083 (for a local installation check http://localhost:3000)) that the InfluxDB is working.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://www.lazzaro.com.ar/post/2016-08-18-using-grafana-to-monitor-linux-or-to-replace-munin/"><meta property="article:section" content="post">
<meta property="article:published_time" content="2016-08-18T00:00:00+00:00">
<meta property="article:modified_time" content="2016-08-18T00:00:00+00:00">
<meta name=twitter:card content="summary">
<meta name=twitter:title content="Monitor linux statistics with grafana (munin replacement)">
<meta name=twitter:description content="This quick tutorial will guide you to install grafana to monitor a linux system. We also are going to save a history to an influx database.
Installing InfluxDB For Ubuntu
curl -sL https://repos.influxdata.com/influxdb.key | sudo apt-key add - source /etc/lsb-release echo &#34;deb https://repos.influxdata.com/${DISTRIB_ID,,}${DISTRIB_CODENAME}stable&#34; | sudo tee /etc/apt/sources.list.d/influxdb.list Install and start theInfluxDB service:
sudo apt-get update && sudo apt-get install influxdb sudo service influxdb start Now you can check at the port 8083 (for a local installation check http://localhost:3000)) that the InfluxDB is working.">
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://www.lazzaro.com.ar/post/"},{"@type":"ListItem","position":3,"name":"Monitor linux statistics with grafana (munin replacement)","item":"https://www.lazzaro.com.ar/post/2016-08-18-using-grafana-to-monitor-linux-or-to-replace-munin/"}]}</script>
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Monitor linux statistics with grafana (munin replacement)","name":"Monitor linux statistics with grafana (munin replacement)","description":"This quick tutorial will guide you to install grafana to monitor a linux system. We also are going to save a history to an influx database.\nInstalling InfluxDB For Ubuntu\ncurl -sL https://repos.influxdata.com/influxdb.key | sudo apt-key add - source /etc/lsb-release echo \u0026#34;deb https://repos.influxdata.com/${DISTRIB_ID,,}${DISTRIB_CODENAME}stable\u0026#34; | sudo tee /etc/apt/sources.list.d/influxdb.list Install and start theInfluxDB service:\nsudo apt-get update \u0026amp;\u0026amp; sudo apt-get install influxdb sudo service influxdb start Now you can check at the port 8083 (for a local installation check http://localhost:3000)) that the InfluxDB is working.","keywords":[],"articleBody":"This quick tutorial will guide you to install grafana to monitor a linux system. We also are going to save a history to an influx database.\nInstalling InfluxDB For Ubuntu\ncurl -sL https://repos.influxdata.com/influxdb.key | sudo apt-key add - source /etc/lsb-release echo \"deb https://repos.influxdata.com/${DISTRIB_ID,,}${DISTRIB_CODENAME}stable\" | sudo tee /etc/apt/sources.list.d/influxdb.list Install and start theInfluxDB service:\nsudo apt-get update \u0026\u0026 sudo apt-get install influxdb sudo service influxdb start Now you can check at the port 8083 (for a local installation check http://localhost:3000)) that the InfluxDB is working.\nSCREENSHOT\nSince InfluxDB default config is a little insecure let’s change some settings:\nsudo vim /etc/influxdb/influxdb.conf Now search for auth-enabled and set it to true.\nit’s recommended to enable also https-enabled\nusing the influx-cli create the admin user (remeber to start the service with influxd):\ninflux\nCREATEUSERleonardoWITHPASSWORD'use_secure_password'WITHALLPRIVILEGES Installing Grafana We need to download the official .deb file (please check the updated .deb here http://grafana.org/download/)\nwget https://grafanarel.s3.amazonaws.com/builds/grafana_3.1.1-1470047149_amd64.deb sudo apt-get install -y adduser libfontconfig sudo dpkg -i grafana_3.1.1-1470047149_amd64.deb sudo service grafana-server start Now check that Grafana web interface is working on localhost at port 3000 (for a local installation check http://localhost:3000).\nSCREENSHOT\nSign up with a new user and then open the grafana configuration (/etc/grafana/grafana.ini) to uncomment admin_user and admin_password\nadmin_user = new_user admin_password = password Then restart grafana\nsudo service grafana-server start Configure InfluxDB data source. Since telegraf database is not yet created an error is expected. Add the datasource as the following screenshot shows.\nSCREENSHOT\nCollect and metrics reporting Now we need a Grafana pluging to collect and report metrics, in this case we are going to use telegraf (https://github.com/influxdata/telegraf)\nwget https://dl.influxdata.com/telegraf/releases/telegraf_1.0.0-beta3_amd64.deb sudo dpkg -i telegraf_1.0.0-beta3_amd64.deb Next step is to configure the pluging. Telegraf can generate a file with specific inputs and outputs, you can use the -input-filter and -output-filter flags\ntelegraf -sample-config -input-filter cpu:mem:net:swap -output-filter influxdb:kafka  telegraf.conf The last command will create a config to monitor CPU, memory, network and swap.\nNow we need to add telegraf as a service.\n","wordCount":"325","inLanguage":"en","datePublished":"2016-08-18T00:00:00Z","dateModified":"2016-08-18T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.lazzaro.com.ar/post/2016-08-18-using-grafana-to-monitor-linux-or-to-replace-munin/"},"publisher":{"@type":"Organization","name":"Leonardo Lazzaro","logo":{"@type":"ImageObject","url":"https://www.lazzaro.com.ar/favicon.ico"}}}</script>
</head>
<body id=top>
<script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add('dark'):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove('dark'):window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script>
<header class=header>
<nav class=nav>
<div class=logo>
<a href=https://www.lazzaro.com.ar accesskey=h title="Leonardo Lazzaro (Alt + H)">Leonardo Lazzaro</a>
<span class=logo-switches>
<button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
</button>
</span>
</div>
<ul id=menu>
<li>
<a href=https://www.lazzaro.com.ar/ title=Home>
<span>Home</span>
</a>
</li>
<li>
<a href=https://www.lazzaro.com.ar/post/ title=Archives>
<span>Archives</span>
</a>
</li>
<li>
<a href=https://www.lazzaro.com.ar/about/ title=About>
<span>About</span>
</a>
</li>
<li>
<a href=https://www.lazzaro.com.ar/photography/ title=Photography>
<span>Photography</span>
</a>
</li>
</ul>
</nav>
</header>
<main class=main>
<article class=post-single>
<header class=post-header>
<h1 class=post-title>
Monitor linux statistics with grafana (munin replacement)
</h1>
<div class=post-meta><span title="2016-08-18 00:00:00 +0000 UTC">2016-08-18</span>
</div>
</header>
<div class=post-content><p>This quick tutorial will guide you to install grafana to monitor a linux system.
We also are going to save a history to an influx database.</p>
<h1 id=installing-influxdb>Installing InfluxDB<a hidden class=anchor aria-hidden=true href=#installing-influxdb>#</a></h1>
<p>For Ubuntu</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash>curl -sL https://repos.influxdata.com/influxdb.key <span class=p>|</span> sudo apt-key add -
<span class=nb>source</span> /etc/lsb-release
<span class=nb>echo</span> <span class=s2>&#34;deb https://repos.influxdata.com/</span><span class=si>${</span><span class=nv>DISTRIB_ID</span><span class=p>,,</span><span class=si>}</span><span class=s2> </span><span class=si>${</span><span class=nv>DISTRIB_CODENAME</span><span class=si>}</span><span class=s2> stable&#34;</span> <span class=p>|</span> sudo tee /etc/apt/sources.list.d/influxdb.list</code></pre></div>
<p>Install and start theInfluxDB service:</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash>sudo apt-get update <span class=o>&amp;&amp;</span> sudo apt-get install influxdb
sudo service influxdb start</code></pre></div>
<p>Now you can check at the port 8083 (for a local installation check http://localhost:3000)) that the InfluxDB is working.</p>
<p>SCREENSHOT</p>
<p>Since InfluxDB default config is a little insecure let&rsquo;s change some settings:</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash>sudo vim /etc/influxdb/influxdb.conf</code></pre></div>
<p>Now search for <em>auth-enabled</em> and set it to true.</p>
<p>it&rsquo;s recommended to enable also <em>https-enabled</em></p>
<p>using the influx-cli create the admin user (remeber to start the service with influxd):</p>
<p>influx</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=k>CREATE</span><span class=w> </span><span class=k>USER</span><span class=w> </span><span class=n>leonardo</span><span class=w> </span><span class=k>WITH</span><span class=w> </span><span class=n>PASSWORD</span><span class=w> </span><span class=s1>&#39;use_secure_password&#39;</span><span class=w> </span><span class=k>WITH</span><span class=w> </span><span class=k>ALL</span><span class=w> </span><span class=k>PRIVILEGES</span></code></pre></div>
<h1 id=installing-grafana>Installing Grafana<a hidden class=anchor aria-hidden=true href=#installing-grafana>#</a></h1>
<p>We need to download the official .deb file (please check the updated .deb here <a href=http://grafana.org/download/>http://grafana.org/download/</a>)</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash>wget https://grafanarel.s3.amazonaws.com/builds/grafana_3.1.1-1470047149_amd64.deb
sudo apt-get install -y adduser libfontconfig
sudo dpkg -i grafana_3.1.1-1470047149_amd64.deb
sudo service grafana-server start</code></pre></div>
<p>Now check that Grafana web interface is working on localhost at port 3000 (for a local installation check http://localhost:3000).</p>
<p>SCREENSHOT</p>
<p>Sign up with a new user and then open the grafana configuration (/etc/grafana/grafana.ini) to uncomment <em>admin_user</em> and <em>admin_password</em></p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=nv>admin_user</span> <span class=o>=</span> new_user
<span class=nv>admin_password</span> <span class=o>=</span> password</code></pre></div>
<p>Then restart grafana</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash>sudo service grafana-server start</code></pre></div>
<p>Configure InfluxDB data source. Since telegraf database is not yet created an error is expected.
Add the datasource as the following screenshot shows.</p>
<p>SCREENSHOT</p>
<h1 id=collect-and-metrics-reporting>Collect and metrics reporting<a hidden class=anchor aria-hidden=true href=#collect-and-metrics-reporting>#</a></h1>
<p>Now we need a Grafana pluging to collect and report metrics, in this case we are going to use telegraf (<a href=https://github.com/influxdata/telegraf>https://github.com/influxdata/telegraf</a>)</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash>wget https://dl.influxdata.com/telegraf/releases/telegraf_1.0.0-beta3_amd64.deb
sudo dpkg -i telegraf_1.0.0-beta3_amd64.deb</code></pre></div>
<p>Next step is to configure the pluging. Telegraf can generate a file with specific inputs and outputs, you can use the -input-filter and -output-filter flags</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash>telegraf -sample-config -input-filter cpu:mem:net:swap -output-filter influxdb:kafka &gt; telegraf.conf</code></pre></div>
<p>The last command will create a config to monitor CPU, memory, network and swap.</p>
<p>Now we need to add telegraf as a service.</p>
</div>
<footer class=post-footer>
</footer>
</article>
</main>
<a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a>
<script>let menu=document.getElementById('menu');menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script>
<script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script>
<script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script>
</body>
</html>